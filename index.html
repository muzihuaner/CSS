<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­å›½ç©ºé—´ç«™å®æ—¶è¿½è¸ª | CSS/ISSå«æ˜Ÿè½¨é“å¯è§†åŒ–</title>
    <meta name="keywords" content="ç©ºé—´ç«™, CSS, ISS, å«æ˜Ÿ, è½¨é“, å®æ—¶è¿½è¸ª, Three.js, å¯è§†åŒ–, ä¸­å›½ç©ºé—´ç«™, å›½é™…ç©ºé—´ç«™">
    <meta name="description" content="ç©ºé—´ç«™å®æ—¶è¿½è¸ªï¼ŒCSSä¸ISSå«æ˜Ÿè½¨é“ä¸‰ç»´å¯è§†åŒ–ï¼Œæ”¯æŒæ ‡ç­¾æ˜¾ç¤ºã€è½¨é“åˆ‡æ¢ã€è§†è§’é”å®šç­‰åŠŸèƒ½ã€‚">
    <meta property="og:title" content="ç©ºé—´ç«™å®æ—¶è¿½è¸ª | CSS/ISSå«æ˜Ÿè½¨é“å¯è§†åŒ–">
    <meta property="og:description" content="ç©ºé—´ç«™å®æ—¶è¿½è¸ªï¼ŒCSSä¸ISSå«æ˜Ÿè½¨é“ä¸‰ç»´å¯è§†åŒ–ï¼Œæ”¯æŒæ ‡ç­¾æ˜¾ç¤ºã€è½¨é“åˆ‡æ¢ã€è§†è§’é”å®šç­‰åŠŸèƒ½ã€‚">
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <meta name="author" content="lihuan">
    <link rel="canonical" href="">
    <script type="application/ld+json">
    {
      "@context": "https://css.quickso.cn",
      "@type": "WebSite",
      "name": "ç©ºé—´ç«™å®æ—¶è¿½è¸ª",
      "description": "ç©ºé—´ç«™å®æ—¶è¿½è¸ªï¼ŒCSSä¸ISSå«æ˜Ÿè½¨é“ä¸‰ç»´å¯è§†åŒ–ï¼Œæ”¯æŒæ ‡ç­¾æ˜¾ç¤ºã€è½¨é“åˆ‡æ¢ã€è§†è§’é”å®šç­‰åŠŸèƒ½ã€‚",
      "url": ""
    }
    </script>
    <style>
                /* èœå•æŒ‰é’®ä¼˜åŒ– */
                #menuBtn {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    background: linear-gradient(90deg,#1a237e 60%,#283593 100%);
                    color: #fff;
                    border: none;
                    padding: 10px 22px;
                    border-radius: 9px;
                    cursor: pointer;
                    font-size: 16px;
                    font-weight: 600;
                    box-shadow: 0 2px 10px #222;
                    transition: background 0.3s, box-shadow 0.3s, transform 0.2s;
                    position: relative;
                }
                #menuBtn:hover {
                    background: linear-gradient(90deg,#283593 60%,#1a237e 100%);
                    box-shadow: 0 4px 16px #111;
                    transform: scale(1.04);
                }
                #menuBtn .menu-icon {
                    font-size: 20px;
                    vertical-align: middle;
                }
                /* èœå•é¢æ¿ä¼˜åŒ– */
                #menuPanel {
                    min-width: 180px;
                    background: rgba(30,33,126,0.98);
                    border-radius: 14px;
                    box-shadow: 0 6px 24px #000a;
                    padding: 22px 28px 18px 28px;
                    z-index: 200;
                    animation: menuFadeIn 0.25s;
                }
                @keyframes menuFadeIn {
                    from { opacity: 0; transform: translateY(20px) scale(0.98); }
                    to   { opacity: 1; transform: translateY(0) scale(1); }
                }
                .menu-action {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    background: linear-gradient(90deg, #283593 60%, #1a237e 100%);
                    color: #fff;
                    border: none;
                    padding: 8px 0 8px 10px;
                    border-radius: 7px;
                    cursor: pointer;
                    font-size: 15px;
                    font-weight: 500;
                    margin-bottom: 4px;
                    box-shadow: 0 1px 4px #222;
                    transition: background 0.3s, transform 0.2s;
                    position: relative;
                }
                .menu-action:hover {
                    background: linear-gradient(90deg, #1a237e 60%, #283593 100%);
                    transform: translateY(-2px) scale(1.04);
                }
                .menu-action .action-icon {
                    font-size: 17px;
                    opacity: 0.85;
                }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #000;
            color: #fff;
            overflow: hidden;
        }

        #container {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        #infoPanel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            max-width: 300px;
            z-index: 100;
        }

        #infoPanel h2 {
            margin-bottom: 10px;
            color: #4fc3f7;
        }

        .station-info {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }

        .station-info h3 {
            color: #fff;
            margin-bottom: 5px;
        }

        .station-info p {
            margin: 3px 0;
            font-size: 14px;
        }

        #controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            z-index: 100;
        }

        #controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            background: rgba(0,0,0,0.5);
            padding: 12px 18px;
            border-radius: 12px;
            box-shadow: 0 2px 8px #000;
        }

        #controls button {
            background: linear-gradient(90deg, #1a237e 60%, #283593 100%);
            color: #fff;
            border: none;
            padding: 9px 18px;
            border-radius: 7px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            box-shadow: 0 1px 4px #222;
            transition: background 0.3s, transform 0.2s;
        }

        #controls button:hover {
            background: linear-gradient(90deg, #283593 60%, #1a237e 100%);
            transform: translateY(-2px) scale(1.04);
        }
            color: #4fc3f7;
        }

        .orbit {
            position: absolute;
            pointer-events: none;
        }

        .label {
            color: white;
            font-size: 16px;
        }
    </style>
</head>

<body>
    <div id="container"></div>

    <div id="infoPanel">
        <div id="currentTime" style="font-size:15px;color:#ffd700;margin-bottom:8px;"></div>
        <h2>ç©ºé—´ç«™è¿½è¸ª</h2>
        <div class="station-info" id="issInfo">
            <h3>å›½é™…ç©ºé—´ç«™ (ISS)</h3>
            <p>ç»åº¦: <span id="issLon">-</span></p>
            <p>çº¬åº¦: <span id="issLat">-</span></p>
            <p>é«˜åº¦: <span id="issAlt">-</span> å…¬é‡Œ</p>
            <p>é€Ÿåº¦: <span id="issVel">-</span> km/s</p>
        </div>
        <div class="station-info" id="cssInfo">
            <h3>ä¸­å›½ç©ºé—´ç«™ (CSS)</h3>
            <p>ç»åº¦: <span id="cssLon">-</span></p>
            <p>çº¬åº¦: <span id="cssLat">-</span></p>
            <p>é«˜åº¦: <span id="cssAlt">-</span> å…¬é‡Œ</p>
            <p>é€Ÿåº¦: <span id="cssVel">-</span> km/s</p>
        </div>
    </div>

    <div id="controls">
                <div style="position:relative;">
                    <button id="menuBtn"><span class="menu-icon">â˜°</span>èœå•</button>
                    <div id="menuPanel" style="display:none;position:absolute;bottom:48px;left:0;background:rgba(30,33,126,0.98);border-radius:10px;box-shadow:0 2px 8px #000;padding:18px 24px;z-index:200;">
                        <form id="menuForm" style="display:flex;flex-direction:column;gap:12px;">
                            <button type="button" class="menu-action" data-action="toggleOrbits"><span class="action-icon">ğŸ›°ï¸</span>æ˜¾ç¤º/éšè—è½¨é“</button>
                            <button type="button" class="menu-action" data-action="toggleLabels"><span class="action-icon">ğŸ·ï¸</span>æ˜¾ç¤º/éšè—æ ‡ç­¾</button>
                            <button type="button" class="menu-action" data-action="resetView"><span class="action-icon">ğŸ”„</span>é‡ç½®è§†è§’</button>
                            <button type="button" class="menu-action" data-action="lockView"><span class="action-icon">ğŸ”’</span>é”å®š/è§£é”è§†è§’</button>
                            <button type="button" class="menu-action" data-action="toggleInfoPanel"><span class="action-icon">ğŸ“‹</span>æ˜¾ç¤º/éšè—ä¿¡æ¯é¢æ¿</button>
                        </form>
                    </div>
                </div>
                <button id="showCssImages">æŸ¥çœ‹ä¸­å›½ç©ºé—´ç«™ä½ç½®å›¾</button>
    </div>

    <!-- å¼¹çª—ç»“æ„ -->
    <div id="cssImagesModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.7);z-index:999;justify-content:center;align-items:center;">
      <div style="background:#222;padding:24px 18px 18px 18px;border-radius:12px;max-width:700px;position:relative;text-align:center;">
        <button id="closeCssImages" style="position:absolute;top:8px;right:12px;background:#4fc3f7;color:#222;border:none;font-size:18px;padding:2px 10px;border-radius:6px;cursor:pointer;">å…³é—­</button>
        <h3 style="color:#ffd700;margin-bottom:12px;">ä¸­å›½ç©ºé—´ç«™è½¨é“ä¸ä½ç½®å›¾</h3>
        <div style="display:flex;flex-wrap:wrap;gap:12px;justify-content:center;align-items:center;">
          <img src="https://www.heavens-above.com/orbitdisplay.aspx?icon=default&width=600&height=300&mode=M&satid=48274" alt="CSSè½¨é“å›¾" style="max-width:100%;border-radius:8px;box-shadow:0 2px 8px #000;">
          <img src="https://www.heavens-above.com/orbitdisplay.aspx?icon=default&width=250&height=250&mode=A&satid=48274" alt="CSSæåŒºå›¾" style="max-width:100%;border-radius:8px;box-shadow:0 2px 8px #000;">
          <img src="https://www.heavens-above.com/orbitdisplay.aspx?icon=default&width=250&height=250&mode=N&satid=48274" alt="CSSèµ¤é“åŒºå›¾" style="max-width:100%;border-radius:8px;box-shadow:0 2px 8px #000;">
        </div>
      </div>
    </div>

    <div class="loading" id="loading">åŠ è½½ä¸­...</div>

    <!-- å¼•å…¥Three.jså’Œå«æ˜Ÿä½ç½®è®¡ç®—åº“ -->
    <script src="https://gcore.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/satellite.js/dist/satellite.min.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/three@0.132.2/examples/js/renderers/CSS2DRenderer.js"></script>

    <script>
        // ä¸»è¦å˜é‡
        let scene, camera, renderer, controls;
        let earth, iss, css;
        let issOrbit, cssOrbit;
        let issData, cssData;
        let showOrbits = true;
        let showLabels = true;
        let viewLocked = false;
        // èœå•ç›¸å…³
        let menuPanelVisible = false;

        function toggleLockView() {
            viewLocked = !viewLocked;
            controls.enabled = !viewLocked;
            const btn = document.getElementById('lockView');
            btn.textContent = viewLocked ? 'è§£é”è§†è§’' : 'é”å®šè§†è§’';
        }

        // TLEæ•°æ®æºURL
        const TLE_ISS_URL = 'https://cors.quickso.cn/https://celestrak.org/NORAD/elements/gp.php?NAME=ISS%20(ZARYA)&FORMAT=tle';
        const TLE_CSS_URL = 'https://cors.quickso.cn/https://celestrak.org/NORAD/elements/gp.php?NAME=CSS%20(TIANHE)&FORMAT=tle';

        // åˆå§‹åŒ–
        function init() {
            // åˆ›å»ºåœºæ™¯
            scene = new THREE.Scene();

            // åˆ›å»ºç›¸æœº
            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            // åˆ›å»ºæ¸²æŸ“å™¨
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.getElementById('container').appendChild(renderer.domElement);

            // åˆ›å»ºCSS2Dæ ‡ç­¾æ¸²æŸ“å™¨
            labelRenderer = new THREE.CSS2DRenderer();
            labelRenderer.setSize(window.innerWidth, window.innerHeight);
            labelRenderer.domElement.style.position = 'absolute';
            labelRenderer.domElement.style.top = '0px';
            labelRenderer.domElement.style.pointerEvents = 'none';
            document.getElementById('container').appendChild(labelRenderer.domElement);

            // æ·»åŠ è½¨é“æ§åˆ¶
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;

            // æ·»åŠ ç¯å¢ƒå…‰
            const ambientLight = new THREE.AmbientLight(0x333333);
            scene.add(ambientLight);

            // æ·»åŠ æ–¹å‘å…‰
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            // directionalLight.position.set(5, 3, 5);
            scene.add(directionalLight);

            // åˆ›å»ºåœ°çƒ
            createEarth();

            // åˆ›å»ºç©ºé—´ç«™æ¨¡å‹
            createSpaceStations();

            // åˆ›å»ºè½¨é“çº¿
            createOrbits();

            // åŠ è½½TLEæ•°æ®
            loadTLEData();

            // æ·»åŠ çª—å£å¤§å°è°ƒæ•´äº‹ä»¶
            window.addEventListener('resize', onWindowResize);

            // æ·»åŠ æ§åˆ¶æŒ‰é’®äº‹ä»¶
            // èœå•æŒ‰é’®äº‹ä»¶
            const menuBtn = document.getElementById('menuBtn');
            const menuPanel = document.getElementById('menuPanel');
            menuBtn.addEventListener('click', function(e) {
                menuPanelVisible = !menuPanelVisible;
                menuPanel.style.display = menuPanelVisible ? 'block' : 'none';
            });
            // å•é€‰æ¡†äº‹ä»¶
            document.getElementById('menuForm').addEventListener('click', function(e) {
                if (e.target.classList.contains('menu-action')) {
                    const action = e.target.getAttribute('data-action');
                    if (action === 'toggleOrbits') toggleOrbits();
                    if (action === 'toggleLabels') toggleLabels();
                    if (action === 'resetView') resetView();
                    if (action === 'lockView') toggleLockView();
                    if (action === 'toggleInfoPanel') toggleInfoPanel();
                    // è‡ªåŠ¨å…³é—­èœå•
                    menuPanelVisible = false;
                    menuPanel.style.display = 'none';
                }
            });
            // ç‚¹å‡»ç©ºç™½å¤„å…³é—­èœå•
            document.addEventListener('click', function(e) {
                if (!menuPanel.contains(e.target) && e.target !== menuBtn) {
                    menuPanelVisible = false;
                    menuPanel.style.display = 'none';
                }
            });
            // ä¿ç•™åŸæœ‰â€œæŸ¥çœ‹ä¸­å›½ç©ºé—´ç«™ä½ç½®å›¾â€æŒ‰é’®
            document.getElementById('showCssImages').addEventListener('click', function() {
                document.getElementById('cssImagesModal').style.display = 'flex';
            });
            document.getElementById('closeCssImages').addEventListener('click', function() {
                document.getElementById('cssImagesModal').style.display = 'none';
            });
        // éšè—/æ˜¾ç¤ºä¿¡æ¯é¢æ¿
        let infoPanelVisible = true;
        function toggleInfoPanel() {
            infoPanelVisible = !infoPanelVisible;
            const infoPanel = document.getElementById('infoPanel');
            if (infoPanelVisible) {
                infoPanel.style.display = '';
            } else {
                infoPanel.style.display = 'none';
            }
        }

            // éšè—åŠ è½½æç¤º
            document.getElementById('loading').style.display = 'none';

            // å¼€å§‹åŠ¨ç”»å¾ªç¯
            animate();
        }

        // åˆ›å»ºåœ°çƒ
        function createEarth() {
            const geometry = new THREE.SphereGeometry(1, 32, 32);
            const textureLoader = new THREE.TextureLoader();
            const texture = textureLoader.load('https://gcore.jsdelivr.net/gh/mrdoob/three.js@dev/examples/textures/planets/earth_atmos_2048.jpg');
            const material = new THREE.MeshPhongMaterial({
                map: texture,
                specular: new THREE.Color(0x333333),
                shininess: 5
            });

            earth = new THREE.Mesh(geometry, material);
            scene.add(earth);

            // æ·»åŠ äº‘å±‚
            const cloudGeometry = new THREE.SphereGeometry(1.01, 32, 32);
            const cloudTexture = textureLoader.load('https://gcore.jsdelivr.net/gh/mrdoob/three.js@dev/examples/textures/planets/earth_clouds_1024.png');
            const cloudMaterial = new THREE.MeshPhongMaterial({
                map: cloudTexture,
                transparent: true,
                opacity: 0.4
            });

            const clouds = new THREE.Mesh(cloudGeometry, cloudMaterial);
            scene.add(clouds);
        }

        // åˆ›å»ºç©ºé—´ç«™æ¨¡å‹
        function createSpaceStations() {
            // å›½é™…ç©ºé—´ç«™Spriteå›¾ç‰‡æ¨¡å‹
            const issTexture = new THREE.TextureLoader().load('ss.png');
            const issMaterial = new THREE.SpriteMaterial({ map: issTexture });
            iss = new THREE.Sprite(issMaterial);
            iss.scale.set(0.15, 0.08, 1); // å¯æ ¹æ®å›¾ç‰‡æ¯”ä¾‹è°ƒæ•´
            scene.add(iss);

            // å›½é™…ç©ºé—´ç«™ğŸ›°åç§°æ ‡ç­¾ï¼ˆä¸Šæ–¹ï¼‰
            const issDiv = document.createElement('div');
            issDiv.className = 'label';
            issDiv.innerHTML = 'ğŸ›° å›½é™…ç©ºé—´ç«™ ISS';
            const issLabel = new THREE.CSS2DObject(issDiv);
            issLabel.position.set(0, 0.12, 0); // ä¸Šæ–¹æ›´æ˜æ˜¾
            iss.add(issLabel);
            iss.issLabel = issLabel; // ä¿å­˜æ ‡ç­¾å¯¹è±¡

            // ...å·²å»é™¤ISSèŒƒå›´åœˆ...

            // ä¸­å›½ç©ºé—´ç«™Spriteå›¾ç‰‡æ¨¡å‹
            const cssTexture = new THREE.TextureLoader().load('ss.png');
            const cssMaterial = new THREE.SpriteMaterial({ map: cssTexture });
            css = new THREE.Sprite(cssMaterial);
            css.scale.set(0.15, 0.08, 1); // å¯æ ¹æ®å›¾ç‰‡æ¯”ä¾‹è°ƒæ•´
            scene.add(css);

            // ä¸­å›½ç©ºé—´ç«™ğŸ›°åç§°æ ‡ç­¾ï¼ˆä¸Šæ–¹ï¼‰
            const cssDiv = document.createElement('div');
            cssDiv.className = 'label';
            cssDiv.innerHTML = 'ğŸ›° ä¸­å›½ç©ºé—´ç«™ CSS';
            const cssLabel = new THREE.CSS2DObject(cssDiv);
            cssLabel.position.set(0, 0.12, 0); // ä¸Šæ–¹æ›´æ˜æ˜¾
            css.add(cssLabel);
            css.cssLabel = cssLabel; // ä¿å­˜æ ‡ç­¾å¯¹è±¡

            // ...å·²å»é™¤CSSèŒƒå›´åœˆ...
        }

        // åˆ›å»ºè½¨é“çº¿
        function createOrbits() {
            // å›½é™…ç©ºé—´ç«™è½¨é“
            const issOrbitGeometry = new THREE.BufferGeometry();
            const issOrbitMaterial = new THREE.LineBasicMaterial({ color: 0x4fc3f7, transparent: true, opacity: 0.5 });
            issOrbit = new THREE.Line(issOrbitGeometry, issOrbitMaterial);
            scene.add(issOrbit);

            // ä¸­å›½ç©ºé—´ç«™è½¨é“
            const cssOrbitGeometry = new THREE.BufferGeometry();
            const cssOrbitMaterial = new THREE.LineBasicMaterial({ color: 0xff9800, transparent: true, opacity: 0.5 });
            cssOrbit = new THREE.Line(cssOrbitGeometry, cssOrbitMaterial);
            scene.add(cssOrbit);
        }

        // åŠ è½½TLEæ•°æ®
        function loadTLEData() {
            // åŠ è½½å›½é™…ç©ºé—´ç«™TLEæ•°æ®
            fetch(TLE_ISS_URL)
                .then(response => response.text())
                .then(data => {
                    const lines = data.trim().split('\n');
                    if (lines.length >= 3) {
                        issData = {
                            name: lines[0].trim(),
                            tleLine1: lines[1],
                            tleLine2: lines[2]
                        };
                        updateISS();
                    }
                })
                .catch(error => console.error('åŠ è½½ISSæ•°æ®å¤±è´¥:', error));

            // åŠ è½½ä¸­å›½ç©ºé—´ç«™TLEæ•°æ®
            fetch(TLE_CSS_URL)
                .then(response => response.text())
                .then(data => {
                    const lines = data.trim().split('\n');
                    if (lines.length >= 3) {
                        cssData = {
                            name: lines[0].trim(),
                            tleLine1: lines[1],
                            tleLine2: lines[2]
                        };
                        updateCSS();
                    }
                })
                .catch(error => console.error('åŠ è½½CSSæ•°æ®å¤±è´¥:', error));
        }

        // æ›´æ–°å›½é™…ç©ºé—´ç«™ä½ç½®
        function updateISS() {
            if (!issData) return;

            const satrec = satellite.twoline2satrec(issData.tleLine1, issData.tleLine2);
            const positionAndVelocity = satellite.propagate(satrec, new Date());

            if (positionAndVelocity.position) {
                const positionEci = positionAndVelocity.position;
                const gmst = satellite.gstime(new Date());
                const positionGd = satellite.eciToGeodetic(positionEci, gmst);

                // è½¬æ¢ä¸ºThree.jsåæ ‡
                const longitude = positionGd.longitude;
                const latitude = positionGd.latitude;
                const height = positionGd.height / 6371; // åœ°çƒåŠå¾„å½’ä¸€åŒ–

                const radius = 1 + height;
                const x = radius * Math.cos(latitude) * Math.cos(-longitude);
                const y = radius * Math.sin(latitude);
                const z = radius * Math.cos(latitude) * Math.sin(-longitude);

                // æ›´æ–°ISSä½ç½®
                iss.position.set(x, y, z);
                // ...å·²å»é™¤ISSèŒƒå›´åœˆåŒæ­¥...

                // æ›´æ–°ä¿¡æ¯é¢æ¿
                document.getElementById('issLon').textContent = (longitude * 180 / Math.PI).toFixed(2) + 'Â°';
                document.getElementById('issLat').textContent = (latitude * 180 / Math.PI).toFixed(2) + 'Â°';
                document.getElementById('issAlt').textContent = (positionGd.height).toFixed(2);

                if (positionAndVelocity.velocity) {
                    const velocity = Math.sqrt(
                        positionAndVelocity.velocity.x * positionAndVelocity.velocity.x +
                        positionAndVelocity.velocity.y * positionAndVelocity.velocity.y +
                        positionAndVelocity.velocity.z * positionAndVelocity.velocity.z
                    );
                    document.getElementById('issVel').textContent = (velocity).toFixed(2);
                }

                // æ›´æ–°è½¨é“çº¿
                if (showOrbits) {
                    updateOrbitLine(satrec, issOrbit, 0x4fc3f7);
                }
            }
        }

        // æ›´æ–°ä¸­å›½ç©ºé—´ç«™ä½ç½®
        function updateCSS() {
            if (!cssData) return;

            const satrec = satellite.twoline2satrec(cssData.tleLine1, cssData.tleLine2);
            const positionAndVelocity = satellite.propagate(satrec, new Date());

            if (positionAndVelocity.position) {
                const positionEci = positionAndVelocity.position;
                const gmst = satellite.gstime(new Date());
                const positionGd = satellite.eciToGeodetic(positionEci, gmst);

                // è½¬æ¢ä¸ºThree.jsåæ ‡
                const longitude = positionGd.longitude;
                const latitude = positionGd.latitude;
                const height = positionGd.height / 6371; // åœ°çƒåŠå¾„å½’ä¸€åŒ–

                const radius = 1 + height;
                const x = radius * Math.cos(latitude) * Math.cos(-longitude);
                const y = radius * Math.sin(latitude);
                const z = radius * Math.cos(latitude) * Math.sin(-longitude);

                // æ›´æ–°CSSä½ç½®
                css.position.set(x, y, z);
                // ...å·²å»é™¤CSSèŒƒå›´åœˆåŒæ­¥...

                // æ›´æ–°ä¿¡æ¯é¢æ¿
                document.getElementById('cssLon').textContent = (longitude * 180 / Math.PI).toFixed(2) + 'Â°';
                document.getElementById('cssLat').textContent = (latitude * 180 / Math.PI).toFixed(2) + 'Â°';
                document.getElementById('cssAlt').textContent = (positionGd.height).toFixed(2);

                if (positionAndVelocity.velocity) {
                    const velocity = Math.sqrt(
                        positionAndVelocity.velocity.x * positionAndVelocity.velocity.x +
                        positionAndVelocity.velocity.y * positionAndVelocity.velocity.y +
                        positionAndVelocity.velocity.z * positionAndVelocity.velocity.z
                    );
                    document.getElementById('cssVel').textContent = (velocity).toFixed(2);
                }

                // æ›´æ–°è½¨é“çº¿
                if (showOrbits) {
                    updateOrbitLine(satrec, cssOrbit, 0xff9800);
                }
            }
        }

        // æ›´æ–°è½¨é“çº¿
        function updateOrbitLine(satrec, orbitLine, color) {
            const points = [];
            const gmst = satellite.gstime(new Date());

            // è®¡ç®—æœªæ¥ä¸€æ®µæ—¶é—´çš„è½¨é“ç‚¹
            for (let i = 0; i <= 100; i++) {
                const time = new Date(Date.now() + i * 60000); // æ¯åˆ†é’Ÿä¸€ä¸ªç‚¹
                const positionAndVelocity = satellite.propagate(satrec, time);

                if (positionAndVelocity.position) {
                    const positionEci = positionAndVelocity.position;
                    const positionGd = satellite.eciToGeodetic(positionEci, gmst);

                    const longitude = positionGd.longitude;
                    const latitude = positionGd.latitude;
                    const height = positionGd.height / 6371;

                    const radius = 1 + height;
                    const x = radius * Math.cos(latitude) * Math.cos(-longitude);
                    const y = radius * Math.sin(latitude);
                    const z = radius * Math.cos(latitude) * Math.sin(-longitude);

                    points.push(new THREE.Vector3(x, y, z));
                }
            }

            orbitLine.geometry.setFromPoints(points);
            orbitLine.material.color.setHex(color);
        }

        // åˆ‡æ¢è½¨é“æ˜¾ç¤º
        function toggleOrbits() {
            showOrbits = !showOrbits;
            issOrbit.visible = showOrbits;
            cssOrbit.visible = showOrbits;
        }

        // åˆ‡æ¢æ ‡ç­¾æ˜¾ç¤º
        function toggleLabels() {
            showLabels = !showLabels;
            if (iss && iss.issLabel) iss.issLabel.visible = showLabels;
            if (css && css.cssLabel) css.cssLabel.visible = showLabels;
        }

        // é‡ç½®è§†è§’
        function resetView() {
            controls.reset();
        }

        // é”å®šè§†è§’
        function lockView() {
            viewLocked = !viewLocked;
            controls.enableRotate = !viewLocked;
            if (viewLocked) {
                document.getElementById('lockView').textContent = 'è§£é”è§†è§’';
            } else {
                document.getElementById('lockView').textContent = 'é”å®šè§†è§’';
            }
        }

        // æŸ¥çœ‹ä¸­å›½ç©ºé—´ç«™ä½ç½®å›¾
        function showCssImages() {
            document.getElementById('cssImagesModal').style.display = 'flex';
        }

        // å…³é—­ä¸­å›½ç©ºé—´ç«™ä½ç½®å›¾å¼¹çª—
        function closeCssImages() {
            document.getElementById('cssImagesModal').style.display = 'none';
        }

        // çª—å£å¤§å°è°ƒæ•´
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            if (labelRenderer) labelRenderer.setSize(window.innerWidth, window.innerHeight);
        }

        // åŠ¨ç”»å¾ªç¯
        function animate() {
            requestAnimationFrame(animate);

            // æ›´æ–°ç©ºé—´ç«™ä½ç½®
            updateISS();
            updateCSS();

            // åœ°çƒä¸å†è‡ªè½¬
            // earth.rotation.y += 0.0005;

            // æ›´æ–°è½¨é“æ§åˆ¶
            controls.update();

            // æ¸²æŸ“åœºæ™¯
            renderer.render(scene, camera);
            labelRenderer.render(scene, camera);
        }

        // æ›´æ–°æ—¶é—´æ˜¾ç¤º
        function updateTime() {
            const now = new Date();
            const yyyy = now.getFullYear();
            const MM = String(now.getMonth() + 1).padStart(2, '0');
            const dd = String(now.getDate()).padStart(2, '0');
            const hh = String(now.getHours()).padStart(2, '0');
            const mm = String(now.getMinutes()).padStart(2, '0');
            const ss = String(now.getSeconds()).padStart(2, '0');
            document.getElementById('currentTime').textContent = `${yyyy}-${MM}-${dd} ${hh}:${mm}:${ss}`;
        }
        setInterval(updateTime, 1000);
        updateTime();

        // åˆå§‹åŒ–åº”ç”¨
        init();
    </script>
</body>

        <!-- å³ä¸‹è§’æ•°æ®æ¥æºå’Œä½œè€…ä¿¡æ¯ -->
        <div id="footerInfo">
            æ•°æ®æ¥æºï¼šCelestrak & Heavens-Above | 
            <a href="https://github.com/muzihuaner/CSS" target="_blank" style="color:#4fc3f7;text-decoration:underline;margin-left:8px;">GitHub</a>
        </div>
        <style>
            #footerInfo {
                position: fixed;
                right: 18px;
                bottom: 12px;
                background: rgba(0,0,0,0.65);
                color: #bbb;
                font-size: 14px;
                border-radius: 8px;
                padding: 7px 16px 7px 12px;
                z-index: 9999;
                box-shadow: 0 2px 8px #000a;
                display: flex;
                align-items: center;
            }
            #footerInfo a:hover {
                color: #ffd700;
            }
        </style>
</html>